2021-06-08  :55:49 - ERROR - user_info.py - 37 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-18' (18387), thread 'MainThread' (4507235776):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x107c61430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x107aee280>
           └ <SpawnProcess name='SpawnProcess-18' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x107ae08b0>
    └ <SpawnProcess name='SpawnProcess-18' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x107ce80a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-18' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-18' parent=15698 started>
    │    └ <function subprocess_started at 0x107c84ca0>
    └ <SpawnProcess name='SpawnProcess-18' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x107ce8040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x107c83e50>
    │    │                  └ <uvicorn.server.Server object at 0x107ce8040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10826e700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10826e670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1082711f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1081c7550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10a634220>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10a634220>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10a634220>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10a634220>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x1086cc700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x1086cc790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108665be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10a572bb0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108665be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10a5784f0>
          └ <fastapi.applications.FastAPI object at 0x10a572bb0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10a583ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10a578550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10a5784f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10a583ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10a578580>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10a578550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10a583d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10a5780a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10a578580>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10a583d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x109421dc0>
          └ <fastapi.routing.APIRoute object at 0x10a5883d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10a583d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10a5a55b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10a583550>
          └ <fastapi.routing.APIRoute object at 0x10a5883d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10a5a5190>
                     └ <function get_request_handler.<locals>.app at 0x10a5834c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10940ed30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10a5a5730>, 'request': <starlette.requests.Request object at 0x10a5...
                 │         └ <function avatar_upload at 0x10a555820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10a5884c0>

> File "./app/api/user_info.py", line 37, in avatar_upload
    avatar_db.save_img(user_id, avatar)
    │         │        │        └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10a00e160>
    └ <utils.services.db.mongodb.MongoDB object at 0x10a54ff40>

  File "./utils/services/db/mongodb.py", line 146, in save_img
    save_data = base64.b64encode(bson.binary.Binary(img.getvalue())).decode('ascii')
                │      │         │    │      │      └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
                │      │         │    │      └ <class 'bson.binary.Binary'>
                │      │         │    └ <module 'bson.binary' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/binary.py'>
                │      │         └ <module 'bson' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/__init__.py'>
                │      └ <function b64encode at 0x107d7bee0>
                └ <module 'base64' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/base64.py'>

AttributeError: 'bytes' object has no attribute 'getvalue'
2021-06-08  :00:48 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-23' (18504), thread 'MainThread' (4488799680):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x108897430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x108724280>
           └ <SpawnProcess name='SpawnProcess-23' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1087218b0>
    └ <SpawnProcess name='SpawnProcess-23' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10891e0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-23' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-23' parent=15698 started>
    │    └ <function subprocess_started at 0x1088baca0>
    └ <SpawnProcess name='SpawnProcess-23' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10891e040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1088ade50>
    │    │                  └ <uvicorn.server.Server object at 0x10891e040>
    │    └ <function BaseEventLoop.run_until_complete at 0x108ea5700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x108ea5670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x108ea81f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x108dfd550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10b275220>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10b275220>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10b275220>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10b275220>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x109302700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x109302790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10929bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10b1a8b80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10929bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10b1ae4f0>
          └ <fastapi.applications.FastAPI object at 0x10b1a8b80>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10b1b9d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10b1ae550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10b1ae4f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10b1b9d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10b1ae580>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10b1ae550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10b1b9dc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10b1ae0a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10b1ae580>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10b1b9dc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10a057dc0>
          └ <fastapi.routing.APIRoute object at 0x10b1be3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10b1b9dc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b1db5b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10b1b95e0>
          └ <fastapi.routing.APIRoute object at 0x10b1be3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10b1db190>
                     └ <function get_request_handler.<locals>.app at 0x10b1b9550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10a044d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10b1db730>, 'request': <starlette.requests.Request object at 0x10b1...
                 │         └ <function avatar_upload at 0x10b18d8b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x10b1be4c0>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id, avatar)
    │         │        │        └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10ac45160>
    └ <utils.services.db.mongodb.MongoDB object at 0x10b187f40>

  File "./utils/services/db/mongodb.py", line 146, in save_img
    save_data = base64.b64encode(bson.binary.Binary(img.getvalue())).decode('ascii')
                │      │         │    │      │      └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
                │      │         │    │      └ <class 'bson.binary.Binary'>
                │      │         │    └ <module 'bson.binary' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/binary.py'>
                │      │         └ <module 'bson' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/__init__.py'>
                │      └ <function b64encode at 0x1089b1ee0>
                └ <module 'base64' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/base64.py'>

AttributeError: 'bytes' object has no attribute 'getvalue'
2021-06-08  :10:02 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-29' (18583), thread 'MainThread' (4451227072):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x101953430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x1017e0280>
           └ <SpawnProcess name='SpawnProcess-29' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1017dd8b0>
    └ <SpawnProcess name='SpawnProcess-29' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1019da0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-29' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-29' parent=15698 started>
    │    └ <function subprocess_started at 0x101978ca0>
    └ <SpawnProcess name='SpawnProcess-29' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1019da040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10196fe50>
    │    │                  └ <uvicorn.server.Server object at 0x1019da040>
    │    └ <function BaseEventLoop.run_until_complete at 0x101f61700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101f61670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101f641f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101eb9550>
    └ <Handle <TaskWakeupMethWrapper object at 0x1043261f0>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x1043261f0>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x1043261f0>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x1043261f0>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x1023be700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x1023be790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102357be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104264b20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102357be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10426a4c0>
          └ <fastapi.applications.FastAPI object at 0x104264b20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104276ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10426a520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10426a4c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104276ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10426a550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10426a520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x104276d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10426a070>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10426a550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x104276d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x103113dc0>
          └ <fastapi.routing.APIRoute object at 0x10427a3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x104276d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x104299580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x104276550>
          └ <fastapi.routing.APIRoute object at 0x10427a3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x104299160>
                     └ <function get_request_handler.<locals>.app at 0x1042764c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1030ffd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x104299700>, 'request': <starlette.requests.Request object at 0x1042...
                 │         └ <function avatar_upload at 0x104245820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10427a490>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id, avatar)
    │         │        │        └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x103d01160>
    └ <utils.services.db.mongodb.MongoDB object at 0x104242f10>

  File "./utils/services/db/mongodb.py", line 146, in save_img
    save_data = base64.b64encode(bson.binary.Binary(img.getvalue())).decode('ascii')
                │      │         │    │      │      └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
                │      │         │    │      └ <class 'bson.binary.Binary'>
                │      │         │    └ <module 'bson.binary' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/binary.py'>
                │      │         └ <module 'bson' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/__init__.py'>
                │      └ <function b64encode at 0x101a6dee0>
                └ <module 'base64' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/base64.py'>

AttributeError: 'bytes' object has no attribute 'getvalue'
2021-06-08  :11:21 - ERROR - user_info.py - 40 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-31' (18608), thread 'MainThread' (4579653056):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x109e37430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x109cc4280>
           └ <SpawnProcess name='SpawnProcess-31' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x109cc18b0>
    └ <SpawnProcess name='SpawnProcess-31' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x109ebe0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-31' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-31' parent=15698 started>
    │    └ <function subprocess_started at 0x109e5aca0>
    └ <SpawnProcess name='SpawnProcess-31' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x109ebe040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x109e53e50>
    │    │                  └ <uvicorn.server.Server object at 0x109ebe040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10a444700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10a444670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10a4471f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10a39d550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10c85a1f0>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10c85a1f0>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10c85a1f0>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10c85a1f0>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10a898700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10a898790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10a83bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10c746b20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10a83bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10c74d4c0>
          └ <fastapi.applications.FastAPI object at 0x10c746b20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10c758ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10c74d520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10c74d4c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10c758ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10c74d550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10c74d520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c758d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10c74d070>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10c74d550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c758d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10b5f7dc0>
          └ <fastapi.routing.APIRoute object at 0x10c75e3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c758d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c77d580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10c758550>
          └ <fastapi.routing.APIRoute object at 0x10c75e3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10c77d160>
                     └ <function get_request_handler.<locals>.app at 0x10c7584c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10b5e3d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10c77d700>, 'request': <starlette.requests.Request object at 0x10c7...
                 │         └ <function avatar_upload at 0x10c72b820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10c75e490>

> File "./app/api/user_info.py", line 40, in avatar_upload
    avatar_db.save_img(user_id, avatar)
    │         │        │        └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10c1e4160>
    └ <utils.services.db.mongodb.MongoDB object at 0x10c725f10>

  File "./utils/services/db/mongodb.py", line 146, in save_img
    save_data = base64.b64encode(bson.binary.Binary(img.getvalue())).decode('ascii')
                │      │         │    │      │      └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
                │      │         │    │      └ <class 'bson.binary.Binary'>
                │      │         │    └ <module 'bson.binary' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/binary.py'>
                │      │         └ <module 'bson' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/__init__.py'>
                │      └ <function b64encode at 0x109f51ee0>
                └ <module 'base64' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/base64.py'>

AttributeError: 'bytes' object has no attribute 'getvalue'
2021-06-08  :11:38 - ERROR - user_info.py - 40 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-32' (18623), thread 'MainThread' (4528965056):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x106d42430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x106bd0280>
           └ <SpawnProcess name='SpawnProcess-32' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x106bc28b0>
    └ <SpawnProcess name='SpawnProcess-32' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x106dca0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-32' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-32' parent=15698 started>
    │    └ <function subprocess_started at 0x106d66ca0>
    └ <SpawnProcess name='SpawnProcess-32' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x106dca040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x106d65e50>
    │    │                  └ <uvicorn.server.Server object at 0x106dca040>
    │    └ <function BaseEventLoop.run_until_complete at 0x107350700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x107350670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1073531f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1072a9550>
    └ <Handle <TaskWakeupMethWrapper object at 0x109721220>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x109721220>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x109721220>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x109721220>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x1077a4700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x1077a4790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x107747be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x109652b50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x107747be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x109659580>
          └ <fastapi.applications.FastAPI object at 0x109652b50>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x109663d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1096595e0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x109659580>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x109663d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x109659610>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1096595e0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x109663dc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1096590a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x109659610>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x109663dc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x108503dc0>
          └ <fastapi.routing.APIRoute object at 0x10966a3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x109663dc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1096875b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1096635e0>
          └ <fastapi.routing.APIRoute object at 0x10966a3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x109687190>
                     └ <function get_request_handler.<locals>.app at 0x109663550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1084efd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x109687730>, 'request': <starlette.requests.Request object at 0x1096...
                 │         └ <function avatar_upload at 0x1096378b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x10966a4c0>

> File "./app/api/user_info.py", line 40, in avatar_upload
    avatar_db.save_img(user_id, avatar)
    │         │        │        └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x1090f0160>
    └ <utils.services.db.mongodb.MongoDB object at 0x109631f40>

  File "./utils/services/db/mongodb.py", line 146, in save_img
    save_data = base64.b64encode(bson.binary.Binary(img.getvalue())).decode('ascii')
                │      │         │    │      │      └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
                │      │         │    │      └ <class 'bson.binary.Binary'>
                │      │         │    └ <module 'bson.binary' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/binary.py'>
                │      │         └ <module 'bson' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/__init__.py'>
                │      └ <function b64encode at 0x106e5dee0>
                └ <module 'base64' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/base64.py'>

AttributeError: 'bytes' object has no attribute 'getvalue'
2021-06-08  :12:02 - ERROR - user_info.py - 40 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-33' (18630), thread 'MainThread' (4750894528):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10e1c5430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10e052280>
           └ <SpawnProcess name='SpawnProcess-33' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10e04f8b0>
    └ <SpawnProcess name='SpawnProcess-33' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10e24c0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-33' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-33' parent=15698 started>
    │    └ <function subprocess_started at 0x10e1e8ca0>
    └ <SpawnProcess name='SpawnProcess-33' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10e24c040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10e1e7e50>
    │    │                  └ <uvicorn.server.Server object at 0x10e24c040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10e7d2700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10e7d2670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10e7d51f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10e72b550>
    └ <Handle <TaskWakeupMethWrapper object at 0x110b76220>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x110b76220>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x110b76220>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x110b76220>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10ec26700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10ec26790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10ebc9be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x110ad4b50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10ebc9be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x110adb4f0>
          └ <fastapi.applications.FastAPI object at 0x110ad4b50>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110ae6ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x110adb550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x110adb4f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110ae6ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x110adb580>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x110adb550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x110ae6d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x110adb0a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x110adb580>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x110ae6d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10f985dc0>
          └ <fastapi.routing.APIRoute object at 0x110aec3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x110ae6d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x110b095b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x110ae6550>
          └ <fastapi.routing.APIRoute object at 0x110aec3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x110b09190>
                     └ <function get_request_handler.<locals>.app at 0x110ae64c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10f972d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x110b09730>, 'request': <starlette.requests.Request object at 0x110b...
                 │         └ <function avatar_upload at 0x110ab9820>
                 └ <fastapi.dependencies.models.Dependant object at 0x110aec4c0>

> File "./app/api/user_info.py", line 40, in avatar_upload
    avatar_db.save_img(user_id, com)
    │         │        │        └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x110572160>
    └ <utils.services.db.mongodb.MongoDB object at 0x110ab4f40>

  File "./utils/services/db/mongodb.py", line 146, in save_img
    save_data = base64.b64encode(bson.binary.Binary(img.getvalue())).decode('ascii')
                │      │         │    │      │      └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
                │      │         │    │      └ <class 'bson.binary.Binary'>
                │      │         │    └ <module 'bson.binary' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/binary.py'>
                │      │         └ <module 'bson' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/bson/__init__.py'>
                │      └ <function b64encode at 0x10e2dfee0>
                └ <module 'base64' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/base64.py'>

AttributeError: 'bytes' object has no attribute 'getvalue'
2021-06-08  :14:19 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-35' (18655), thread 'MainThread' (4602082752):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10d003430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10ce90280>
           └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10ce828b0>
    └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10d08a0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
    │    └ <function subprocess_started at 0x10d028ca0>
    └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10d08a040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10d01fe50>
    │    │                  └ <uvicorn.server.Server object at 0x10d08a040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10d610700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10d610670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10d6131f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10d569550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10f9d6220>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10f9d6220>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10f9d6220>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10f9d6220>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10da6e700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10da6e790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10da07be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10f915b50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10da07be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10f91b4f0>
          └ <fastapi.applications.FastAPI object at 0x10f915b50>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10f926ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10f91b550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10f91b4f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10f926ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10f91b580>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10f91b550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10f926d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10f91b0a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10f91b580>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10f926d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10e7c3dc0>
          └ <fastapi.routing.APIRoute object at 0x10f92a3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10f926d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9475b0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10f926550>
          └ <fastapi.routing.APIRoute object at 0x10f92a3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10f947190>
                     └ <function get_request_handler.<locals>.app at 0x10f9264c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10e7afd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10f947730>, 'request': <starlette.requests.Request object at 0x10f9...
                 │         └ <function avatar_upload at 0x10f8f8820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10f92a4c0>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id, BytesIO(avatar))
    │         │        │        │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        │        └ <class '_io.BytesIO'>
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10f3b1160>
    └ <utils.services.db.mongodb.MongoDB object at 0x10f8f3f40>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {'img': save_data})
    │    │          │                      │                 └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x10ef1fe50>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x10f8f3f40>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'img': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRI...
    │      └ <function validate_ok_for_update at 0x10eea4790>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :15:07 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-35' (18655), thread 'MainThread' (4602082752):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10d003430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10ce90280>
           └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10ce828b0>
    └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10d08a0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
    │    └ <function subprocess_started at 0x10d028ca0>
    └ <SpawnProcess name='SpawnProcess-35' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10d08a040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10d01fe50>
    │    │                  └ <uvicorn.server.Server object at 0x10d08a040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10d610700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10d610670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10d6131f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10d569550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10f947a00>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10f947a00>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10f947a00>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10f947a00>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10da6e700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10da6e790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10da07be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10f915b50>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10da07be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10f91b4f0>
          └ <fastapi.applications.FastAPI object at 0x10f915b50>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10f9fa550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10f91b550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10f91b4f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10f9fa550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10f91b580>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10f91b550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10f9fa0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10f91b0a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10f91b580>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10f9fa0d0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10e7c3dc0>
          └ <fastapi.routing.APIRoute object at 0x10f92a3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10f9fa0d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10f9d6e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10f926550>
          └ <fastapi.routing.APIRoute object at 0x10f92a3d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10f9d6f10>
                     └ <function get_request_handler.<locals>.app at 0x10f9264c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10e7afd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10f9d6070>, 'request': <starlette.requests.Request object at 0x10f9...
                 │         └ <function avatar_upload at 0x10f8f8820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10f92a4c0>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id, BytesIO(avatar))
    │         │        │        │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │        │        └ <class '_io.BytesIO'>
    │         │        └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10f3b1160>
    └ <utils.services.db.mongodb.MongoDB object at 0x10f8f3f40>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {'img': save_data})
    │    │          │                      │                 └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x10ef1fe50>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x10f8f3f40>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'img': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRI...
    │      └ <function validate_ok_for_update at 0x10eea4790>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :22:38 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-40' (18764), thread 'MainThread' (4547593664):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1058d2430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10575f280>
           └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10575c8b0>
    └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1059590a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
    │    └ <function subprocess_started at 0x1058f5ca0>
    └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105959040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1058eee50>
    │    │                  └ <uvicorn.server.Server object at 0x105959040>
    │    └ <function BaseEventLoop.run_until_complete at 0x105edf700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105edf670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105ee21f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105e38550>
    └ <Handle <TaskWakeupMethWrapper object at 0x1082a51c0>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x1082a51c0>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x1082a51c0>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x1082a51c0>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10633d700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10633d790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1062d6be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1081e3af0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1062d6be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1081ea490>
          └ <fastapi.applications.FastAPI object at 0x1081e3af0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1081f5ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1081ea4f0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1081ea490>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1081f5ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x1081ea520>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1081ea4f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1081f5d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1081ea040>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x1081ea520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1081f5d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x107092dc0>
          └ <fastapi.routing.APIRoute object at 0x1081f8370>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1081f5d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108218550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1081f5550>
          └ <fastapi.routing.APIRoute object at 0x1081f8370>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x108218130>
                     └ <function get_request_handler.<locals>.app at 0x1081f54c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10707fd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x1082186d0>, 'request': <starlette.requests.Request object at 0x1082...
                 │         └ <function avatar_upload at 0x1081c7820>
                 └ <fastapi.dependencies.models.Dependant object at 0x1081f8460>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id=user_id, img=BytesIO(avatar), img_name='avatar')
    │         │                │            │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │                │            └ <class '_io.BytesIO'>
    │         │                └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x107c7f160>
    └ <utils.services.db.mongodb.MongoDB object at 0x1081c3ee0>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {f'{img_name}': save_data})
    │    │          │                      │                         └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x1077eee50>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x1081c3ee0>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'avatar': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuM...
    │      └ <function validate_ok_for_update at 0x107773790>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :23:18 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-40' (18764), thread 'MainThread' (4547593664):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1058d2430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10575f280>
           └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10575c8b0>
    └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1059590a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
    │    └ <function subprocess_started at 0x1058f5ca0>
    └ <SpawnProcess name='SpawnProcess-40' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105959040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1058eee50>
    │    │                  └ <uvicorn.server.Server object at 0x105959040>
    │    └ <function BaseEventLoop.run_until_complete at 0x105edf700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105edf670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105ee21f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105e38550>
    └ <Handle <TaskWakeupMethWrapper object at 0x108218dc0>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x108218dc0>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x108218dc0>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x108218dc0>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10633d700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10633d790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1062d6be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1081e3af0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1062d6be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1081ea490>
          └ <fastapi.applications.FastAPI object at 0x1081e3af0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1082c9550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1081ea4f0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1081ea490>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1082c9550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x1081ea520>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1081ea4f0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1082c90d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1081ea040>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x1081ea520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1082c90d0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x107092dc0>
          └ <fastapi.routing.APIRoute object at 0x1081f8370>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1082c90d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1082a5e20>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1081f5550>
          └ <fastapi.routing.APIRoute object at 0x1081f8370>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1082a5790>
                     └ <function get_request_handler.<locals>.app at 0x1081f54c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10707fd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x1082a57f0>, 'request': <starlette.requests.Request object at 0x1082...
                 │         └ <function avatar_upload at 0x1081c7820>
                 └ <fastapi.dependencies.models.Dependant object at 0x1081f8460>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id=user_id, img=BytesIO(avatar), img_name='avatar')
    │         │                │            │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │                │            └ <class '_io.BytesIO'>
    │         │                └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x107c7f160>
    └ <utils.services.db.mongodb.MongoDB object at 0x1081c3ee0>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {f'{img_name}': save_data})
    │    │          │                      │                         └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x1077eee50>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x1081c3ee0>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'avatar': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuM...
    │      └ <function validate_ok_for_update at 0x107773790>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :25:45 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-42' (18792), thread 'MainThread' (4440098240):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x106002430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x105e8f280>
           └ <SpawnProcess name='SpawnProcess-42' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105e8c8b0>
    └ <SpawnProcess name='SpawnProcess-42' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1060890a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=15698 started>
    │    └ <function subprocess_started at 0x106027ca0>
    └ <SpawnProcess name='SpawnProcess-42' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x106089040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x106018e50>
    │    │                  └ <uvicorn.server.Server object at 0x106089040>
    │    └ <function BaseEventLoop.run_until_complete at 0x106610700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x106610670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1066131f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x106568550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10895d310>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10895d310>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10895d310>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10895d310>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x106a6d700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x106a6d790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x106a06be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x108913b20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x106a06be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10891a4c0>
          └ <fastapi.applications.FastAPI object at 0x108913b20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x108925ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10891a520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10891a4c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x108925ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10891a550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10891a520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x108925d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10891a070>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10891a550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x108925d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x1077c2dc0>
          └ <fastapi.routing.APIRoute object at 0x1089283a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x108925d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x108948580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x108925550>
          └ <fastapi.routing.APIRoute object at 0x1089283a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x108948160>
                     └ <function get_request_handler.<locals>.app at 0x1089254c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1077aed30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x108948700>, 'request': <starlette.requests.Request object at 0x1089...
                 │         └ <function avatar_upload at 0x1088f7820>
                 └ <fastapi.dependencies.models.Dependant object at 0x108928490>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id=user_id, img=BytesIO(avatar), img_name='avatar')
    │         │                │            │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │                │            └ <class '_io.BytesIO'>
    │         │                └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x1083af160>
    └ <utils.services.db.mongodb.MongoDB object at 0x1088f3f10>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {f'{img_name}': save_data})
    │    │          │                      │                         └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x107f1ee50>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x1088f3f10>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'avatar': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuM...
    │      └ <function validate_ok_for_update at 0x107ea3790>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :26:41 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-43' (18809), thread 'MainThread' (4493891008):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10b217430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10b0a4280>
           └ <SpawnProcess name='SpawnProcess-43' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10b0a18b0>
    └ <SpawnProcess name='SpawnProcess-43' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10b29e0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-43' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-43' parent=15698 started>
    │    └ <function subprocess_started at 0x10b23aca0>
    └ <SpawnProcess name='SpawnProcess-43' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10b29e040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10b233e50>
    │    │                  └ <uvicorn.server.Server object at 0x10b29e040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10b825700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10b825670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10b8281f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10b77d550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10dd071f0>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10dd071f0>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10dd071f0>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10dd071f0>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10bc82700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10bc82790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10bc1bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10dbf5b20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10bc1bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10dbfc4c0>
          └ <fastapi.applications.FastAPI object at 0x10dbf5b20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10dc06d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10dbfc520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10dbfc4c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10dc06d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10dbfc550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10dbfc520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10dc06dc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10dbfc070>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10dbfc550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10dc06dc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10caa8dc0>
          └ <fastapi.routing.APIRoute object at 0x10dc0a3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10dc06dc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10dc2a580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10dc065e0>
          └ <fastapi.routing.APIRoute object at 0x10dc0a3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10dc2a160>
                     └ <function get_request_handler.<locals>.app at 0x10dc06550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10ca95d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10dc2a700>, 'request': <starlette.requests.Request object at 0x10dc...
                 │         └ <function avatar_upload at 0x10dbd78b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x10dc0a490>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id=user_id, img=BytesIO(avatar), img_name='avatar')
    │         │                │            │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │                │            └ <class '_io.BytesIO'>
    │         │                └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10d6911f0>
    └ <utils.services.db.mongodb.MongoDB object at 0x10dbd5f10>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {f'{img_name}': save_data})
    │    │          │                      │                         └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x10d201ee0>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x10dbd5f10>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'avatar': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuM...
    │      └ <function validate_ok_for_update at 0x10d185820>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :27:16 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-44' (18818), thread 'MainThread' (4635686336):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x108202430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10808f280>
           └ <SpawnProcess name='SpawnProcess-44' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10808c8b0>
    └ <SpawnProcess name='SpawnProcess-44' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1082890a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-44' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-44' parent=15698 started>
    │    └ <function subprocess_started at 0x108227ca0>
    └ <SpawnProcess name='SpawnProcess-44' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x108289040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x108218e50>
    │    │                  └ <uvicorn.server.Server object at 0x108289040>
    │    └ <function BaseEventLoop.run_until_complete at 0x108810700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x108810670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1088131f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x108768550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10abd5310>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10abd5310>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10abd5310>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10abd5310>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x108c66700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x108c66790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108c06be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10ab14b20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108c06be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10ab1a4c0>
          └ <fastapi.applications.FastAPI object at 0x10ab14b20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10ab25ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10ab1a520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10ab1a4c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10ab25ca0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10ab1a550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10ab1a520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10ab25d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10ab1a070>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10ab1a550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10ab25d30>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x1099c2dc0>
          └ <fastapi.routing.APIRoute object at 0x10ab283a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10ab25d30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ab48580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10ab25550>
          └ <fastapi.routing.APIRoute object at 0x10ab283a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10ab48190>
                     └ <function get_request_handler.<locals>.app at 0x10ab254c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1099afd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x10ab48070>, 'request': <starlette.requests.Request object at 0x10ab...
                 │         └ <function avatar_upload at 0x10aaf7820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10ab28490>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id=user_id, img=BytesIO(avatar), img_name='avatar')
    │         │                │            │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │                │            └ <class '_io.BytesIO'>
    │         │                └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x10a5af160>
    └ <utils.services.db.mongodb.MongoDB object at 0x10aaf3f10>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {f'{img_name}': save_data})
    │    │          │                      │                         └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x10a11ee50>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x10aaf3f10>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'avatar': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuM...
    │      └ <function validate_ok_for_update at 0x10a0a3790>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
2021-06-08  :27:39 - ERROR - user_info.py - 38 - An error has been caught in function 'avatar_upload', process 'SpawnProcess-45' (18821), thread 'MainThread' (4586755520):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x101e98430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x101d25280>
           └ <SpawnProcess name='SpawnProcess-45' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x101d228b0>
    └ <SpawnProcess name='SpawnProcess-45' parent=15698 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101f1f0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-45' parent=15698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-45' parent=15698 started>
    │    └ <function subprocess_started at 0x101ebdca0>
    └ <SpawnProcess name='SpawnProcess-45' parent=15698 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101f1f040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x101eaee50>
    │    │                  └ <uvicorn.server.Server object at 0x101f1f040>
    │    └ <function BaseEventLoop.run_until_complete at 0x1024a6700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1024a6670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1024a91f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1023fe550>
    └ <Handle <TaskWakeupMethWrapper object at 0x1047f41f0>(<Future finis...6988381601792>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x1047f41f0>(<Future finis...6988381601792>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x1047f41f0>(<Future finis...6988381601792>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x1047f41f0>(<Future finis...6988381601792>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x1028fb700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x1028fb790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10289cbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1047a9b20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10289cbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1047b04c0>
          └ <fastapi.applications.FastAPI object at 0x1047a9b20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1047bad30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1047b0520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1047b04c0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1047bad30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x1047b0550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1047b0520>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1047badc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1047b0070>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x1047b0550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1047badc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x103658dc0>
          └ <fastapi.routing.APIRoute object at 0x1047be3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1047badc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1047de580>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1047ba5e0>
          └ <fastapi.routing.APIRoute object at 0x1047be3a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1047de160>
                     └ <function get_request_handler.<locals>.app at 0x1047ba550>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x103645d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': <starlette.datastructures.UploadFile object at 0x1047de700>, 'request': <starlette.requests.Request object at 0x1047...
                 │         └ <function avatar_upload at 0x10478b8b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x1047be490>

> File "./app/api/user_info.py", line 38, in avatar_upload
    avatar_db.save_img(user_id=user_id, img=BytesIO(avatar), img_name='avatar')
    │         │                │            │       └ b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x05\x9f\x00\x00\x03\x15\x08\x06\x00\x00\x00\x18\x8f\x8a\x81\x00\x00\x18OiCCPICC...
    │         │                │            └ <class '_io.BytesIO'>
    │         │                └ 3470266988381601792
    │         └ <function MongoDB.save_img at 0x1042451f0>
    └ <utils.services.db.mongodb.MongoDB object at 0x104789f10>

  File "./utils/services/db/mongodb.py", line 148, in save_img
    self.collection.update_one({'user_id': user_id}, {f'{img_name}': save_data})
    │    │          │                      │                         └ 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuMZRIMpWoEKWS...
    │    │          │                      └ 3470266988381601792
    │    │          └ <function Collection.update_one at 0x103db5ee0>
    │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'av...
    └ <utils.services.db.mongodb.MongoDB object at 0x104789f10>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1014, in update_one
    common.validate_ok_for_update(update)
    │      │                      └ {'avatar': 'iVBORw0KGgoAAAANSUhEUgAABZ8AAAMVCAYAAAAYj4qBAAAYT2lDQ1BJQ0MgUHJvZmlsZQAAWIWVWQk0Vd3b3+fO95rvNc/zTOZ5nud5JuGarimuM...
    │      └ <function validate_ok_for_update at 0x103d39820>
    └ <module 'pymongo.common' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py'>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/common.py", line 557, in validate_ok_for_update
    raise ValueError('update only works with $ operators')

ValueError: update only works with $ operators
