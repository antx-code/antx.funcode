2021-06-05  :45:26 - ERROR - users.py - 76 - An error has been caught in function 'register_email', process 'SpawnProcess-31' (5009), thread 'MainThread' (4755936704):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10d4dc430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10d36a280>
           └ <SpawnProcess name='SpawnProcess-31' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10d35c8b0>
    └ <SpawnProcess name='SpawnProcess-31' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10d5640a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-31' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-31' parent=3087 started>
    │    └ <function subprocess_started at 0x10d500ca0>
    └ <SpawnProcess name='SpawnProcess-31' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10d564040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10d4ffe50>
    │    │                  └ <uvicorn.server.Server object at 0x10d564040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10daea700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10daea670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10daec1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10da43550>
    └ <Handle <TaskStepMethWrapper object at 0x10fc7fd00>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10fc7fd00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10fc7fd00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10fc7fd00>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10df4a700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10df4a790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10dee0be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10fc70ee0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10dee0be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10fc728b0>
          └ <fastapi.applications.FastAPI object at 0x10fc70ee0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10fc7c550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10fc72910>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10fc728b0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10fc7c550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10fc72940>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10fc72910>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10fc7c5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10fc720a0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10fc72940>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10fc7c5e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10ec9edc0>
          └ <fastapi.routing.APIRoute object at 0x10fc728e0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10fc7c5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10fc7fcd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10fc7c160>
          └ <fastapi.routing.APIRoute object at 0x10fc728e0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10fc7f910>
                     └ <function get_request_handler.<locals>.app at 0x10fc76b80>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10ec88d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserRegisterEmail(email='wkaifeng2007@163.com', password='IWILLHACKYOU123', is_active=True, is_superuser=False,...
                 │         └ <function register_email at 0x10fc60af0>
                 └ <fastapi.dependencies.models.Dependant object at 0x10fc727c0>

> File "./api/app/users.py", line 76, in register_email
    mongodb.insert_one_data(save_info)
    │       │               └ {'user_id': '3469890220629950464', 'email': 'wkaifeng2007@163.com', 'password': '2f37379b8c2f4b60ba35682959f4c6e4', '_id': Ob...
    │       └ <function MongoDB.insert_one_data at 0x10fa51ca0>
    └ <utils.services.db.mongodb.MongoDB object at 0x10fc7ff10>

  File "./utils/services/db/mongodb.py", line 50, in insert_one_data
    self.collection.insert_one(data_dict)
    │    │          │          └ {'user_id': '3469890220629950464', 'email': 'wkaifeng2007@163.com', 'password': '2f37379b8c2f4b60ba35682959f4c6e4', '_id': Ob...
    │    │          └ <function Collection.insert_one at 0x10f4103a0>
    │    └ Collection(Database(MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), '...
    └ <utils.services.db.mongodb.MongoDB object at 0x10fc7ff10>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 698, in insert_one
    self._insert(document,
    │    │       └ {'user_id': '3469890220629950464', 'email': 'wkaifeng2007@163.com', 'password': '2f37379b8c2f4b60ba35682959f4c6e4', '_id': Ob...
    │    └ <function Collection._insert at 0x10f410310>
    └ Collection(Database(MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), '...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 613, in _insert
    return self._insert_one(
           │    └ <function Collection._insert_one at 0x10f410280>
           └ Collection(Database(MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), '...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 602, in _insert_one
    self.__database.client._retryable_write(
    └ Collection(Database(MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), '...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1497, in _retryable_write
    with self._tmp_session(session) as s:
         │    │            └ None
         │    └ <function MongoClient._tmp_session at 0x10f4ba310>
         └ MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 113, in __enter__
    return next(self.gen)
                │    └ <generator object MongoClient._tmp_session at 0x10fec74a0>
                └ <contextlib._GeneratorContextManager object at 0x10fc9a790>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1829, in _tmp_session
    s = self._ensure_session(session)
        │    │               └ None
        │    └ <function MongoClient._ensure_session at 0x10f4ba1f0>
        └ MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1816, in _ensure_session
    return self.__start_session(True, causal_consistency=False)
           └ MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1766, in __start_session
    server_session = self._get_server_session()
                     │    └ <function MongoClient._get_server_session at 0x10f4ba0d0>
                     └ MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1802, in _get_server_session
    return self._topology.get_server_session()
           │    │         └ <function Topology.get_server_session at 0x10f4b2af0>
           │    └ <Topology <TopologyDescription id: 60ba669810fd393aa1153429, topology_type: Single, servers: [<ServerDescription ('10.125.0.2...
           └ MongoClient(host=['10.125.0.28:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/topology.py", line 496, in get_server_session
    self._select_servers_loop(
    │    └ <function Topology._select_servers_loop at 0x10f4b0dc0>
    └ <Topology <TopologyDescription id: 60ba669810fd393aa1153429, topology_type: Single, servers: [<ServerDescription ('10.125.0.2...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/topology.py", line 215, in _select_servers_loop
    raise ServerSelectionTimeoutError(
          └ <class 'pymongo.errors.ServerSelectionTimeoutError'>

pymongo.errors.ServerSelectionTimeoutError: 10.125.0.28:27017: timed out, Timeout: 30s, Topology Description: <TopologyDescription id: 60ba669810fd393aa1153429, topology_type: Single, servers: [<ServerDescription ('10.125.0.28', 27017) server_type: Unknown, rtt: None, error=NetworkTimeout('10.125.0.28:27017: timed out')>]>
2021-06-05  :07:14 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-88' (7021), thread 'MainThread' (4679325120):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1106c0430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x11054e280>
           └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1105408b0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1107480a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    └ <function subprocess_started at 0x1106e4ca0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x110748040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1106e3e50>
    │    │                  └ <uvicorn.server.Server object at 0x110748040>
    │    └ <function BaseEventLoop.run_until_complete at 0x110cce700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x110cce670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x110cd01f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x110c27550>
    └ <Handle <TaskStepMethWrapper object at 0x112fa7a60>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x112fa7a60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x112fa7a60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x112fa7a60>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x111129700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x111129790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x112f8ad60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
          └ <fastapi.applications.FastAPI object at 0x112f8ad60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x112f8e280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x111e82dc0>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x112f91a60>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x112fa7670>
                     └ <function get_request_handler.<locals>.app at 0x112f919d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x111e6cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('044bc7fc-0819-4dbc-9a7a-66882bf4000d'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x112f7d550>
                 └ <fastapi.dependencies.models.Dependant object at 0x112f98250>

> File "./app/api/user.py", line 101, in login
    redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
    │             │                    │                  └ 1
    │             │                    └ '3469911271959166976'
    │             └ <function RedisService.set_dep_key at 0x11238bf70>
    └ <utils.services.redis.redis_service.RedisService object at 0x112e9aa90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :07:18 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-88' (7021), thread 'MainThread' (4679325120):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1106c0430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x11054e280>
           └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1105408b0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1107480a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    └ <function subprocess_started at 0x1106e4ca0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x110748040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1106e3e50>
    │    │                  └ <uvicorn.server.Server object at 0x110748040>
    │    └ <function BaseEventLoop.run_until_complete at 0x110cce700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x110cce670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x110cd01f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x110c27550>
    └ <Handle <TaskStepMethWrapper object at 0x112fa7a30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x112fa7a30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x112fa7a30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x112fa7a30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x111129700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x111129790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x112f8ad60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
          └ <fastapi.applications.FastAPI object at 0x112f8ad60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x112f8e280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x111e82dc0>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7070>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x112f91a60>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x112fa7130>
                     └ <function get_request_handler.<locals>.app at 0x112f919d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x111e6cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('63b72990-745c-4718-87be-87e0886d9093'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x112f7d550>
                 └ <fastapi.dependencies.models.Dependant object at 0x112f98250>

> File "./app/api/user.py", line 101, in login
    redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
    │             │                    │                  └ 2
    │             │                    └ '3469911271959166976'
    │             └ <function RedisService.set_dep_key at 0x11238bf70>
    └ <utils.services.redis.redis_service.RedisService object at 0x112e9aa90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :07:19 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-88' (7021), thread 'MainThread' (4679325120):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1106c0430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x11054e280>
           └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1105408b0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1107480a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    └ <function subprocess_started at 0x1106e4ca0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x110748040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1106e3e50>
    │    │                  └ <uvicorn.server.Server object at 0x110748040>
    │    └ <function BaseEventLoop.run_until_complete at 0x110cce700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x110cce670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x110cd01f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x110c27550>
    └ <Handle <TaskStepMethWrapper object at 0x112fa7a90>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x112fa7a90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x112fa7a90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x112fa7a90>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x111129700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x111129790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x112f8ad60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
          └ <fastapi.applications.FastAPI object at 0x112f8ad60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x112f8e280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x111e82dc0>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fc6df0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x112f91a60>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x112fa7d60>
                     └ <function get_request_handler.<locals>.app at 0x112f919d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x111e6cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('71c2e0ab-c3cc-4a27-b6ca-74a80492379e'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x112f7d550>
                 └ <fastapi.dependencies.models.Dependant object at 0x112f98250>

> File "./app/api/user.py", line 101, in login
    redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
    │             │                    │                  └ 3
    │             │                    └ '3469911271959166976'
    │             └ <function RedisService.set_dep_key at 0x11238bf70>
    └ <utils.services.redis.redis_service.RedisService object at 0x112e9aa90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :07:20 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-88' (7021), thread 'MainThread' (4679325120):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1106c0430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x11054e280>
           └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1105408b0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1107480a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    └ <function subprocess_started at 0x1106e4ca0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x110748040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1106e3e50>
    │    │                  └ <uvicorn.server.Server object at 0x110748040>
    │    └ <function BaseEventLoop.run_until_complete at 0x110cce700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x110cce670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x110cd01f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x110c27550>
    └ <Handle <TaskStepMethWrapper object at 0x112e9a9a0>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x112e9a9a0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x112e9a9a0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x112e9a9a0>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x111129700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x111129790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x112f8ad60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
          └ <fastapi.applications.FastAPI object at 0x112f8ad60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x112f8e280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x111e82dc0>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa75e0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x112f91a60>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x112fa7a90>
                     └ <function get_request_handler.<locals>.app at 0x112f919d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x111e6cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('39c0bf15-daca-4d5c-a8eb-7f0447a3bce7'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x112f7d550>
                 └ <fastapi.dependencies.models.Dependant object at 0x112f98250>

> File "./app/api/user.py", line 101, in login
    redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
    │             │                    │                  └ 4
    │             │                    └ '3469911271959166976'
    │             └ <function RedisService.set_dep_key at 0x11238bf70>
    └ <utils.services.redis.redis_service.RedisService object at 0x112e9aa90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :07:20 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-88' (7021), thread 'MainThread' (4679325120):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1106c0430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x11054e280>
           └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1105408b0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1107480a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    └ <function subprocess_started at 0x1106e4ca0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x110748040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1106e3e50>
    │    │                  └ <uvicorn.server.Server object at 0x110748040>
    │    └ <function BaseEventLoop.run_until_complete at 0x110cce700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x110cce670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x110cd01f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x110c27550>
    └ <Handle <TaskStepMethWrapper object at 0x112a6e550>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x112a6e550>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x112a6e550>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x112a6e550>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x111129700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x111129790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x112f8ad60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
          └ <fastapi.applications.FastAPI object at 0x112f8ad60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x112f8e280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x111e82dc0>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9e5e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x112fa7cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x112f91a60>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x112fc6e50>
                     └ <function get_request_handler.<locals>.app at 0x112f919d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x111e6cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('5b80797b-d6f7-4352-96e5-3bffb43f8a08'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x112f7d550>
                 └ <fastapi.dependencies.models.Dependant object at 0x112f98250>

> File "./app/api/user.py", line 101, in login
    redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
    │             │                    │                  └ 5
    │             │                    └ '3469911271959166976'
    │             └ <function RedisService.set_dep_key at 0x11238bf70>
    └ <utils.services.redis.redis_service.RedisService object at 0x112e9aa90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :08:45 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-88' (7021), thread 'MainThread' (4679325120):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1106c0430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x11054e280>
           └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1105408b0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1107480a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
    │    └ <function subprocess_started at 0x1106e4ca0>
    └ <SpawnProcess name='SpawnProcess-88' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x110748040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1106e3e50>
    │    │                  └ <uvicorn.server.Server object at 0x110748040>
    │    └ <function BaseEventLoop.run_until_complete at 0x110cce700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x110cce670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x110cd01f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x110c27550>
    └ <Handle <TaskStepMethWrapper object at 0x1130a7ac0>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1130a7ac0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1130a7ac0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1130a7ac0>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x111129700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x111129790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x112f8ad60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1110c4be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
          └ <fastapi.applications.FastAPI object at 0x112f8ad60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e670>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x112f8e6d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x112f9e670>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x112f8e730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9ea60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x112f8e280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x112f8e760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9ea60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x111e82dc0>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x112f9ea60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1130a7a90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x112f91a60>
          └ <fastapi.routing.APIRoute object at 0x112f98160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1130a7340>
                     └ <function get_request_handler.<locals>.app at 0x112f919d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x111e6cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('c1c1b08c-5534-4003-a8f8-2df574e221b3'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x112f7d550>
                 └ <fastapi.dependencies.models.Dependant object at 0x112f98250>

> File "./app/api/user.py", line 101, in login
    redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
    │             │                    │                  └ 1
    │             │                    └ '3469911271959166976'
    │             └ <function RedisService.set_dep_key at 0x11238bf70>
    └ <utils.services.redis.redis_service.RedisService object at 0x112e9aa90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :12:51 - ERROR - user.py - 101 - An error has been caught in function 'login', process 'SpawnProcess-92' (7087), thread 'MainThread' (4558263744):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x1099ab430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x109839280>
           └ <SpawnProcess name='SpawnProcess-92' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10982b8b0>
    └ <SpawnProcess name='SpawnProcess-92' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x109a330a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-92' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-92' parent=3087 started>
    │    └ <function subprocess_started at 0x1099cfca0>
    └ <SpawnProcess name='SpawnProcess-92' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x109a33040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x1099cee50>
    │    │                  └ <uvicorn.server.Server object at 0x109a33040>
    │    └ <function BaseEventLoop.run_until_complete at 0x109fb9700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x109fb9670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x109fbc1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x109f12550>
    └ <Handle <TaskStepMethWrapper object at 0x10c292a60>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10c292a60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10c292a60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10c292a60>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10a40f700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10a40f790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10a3afbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10c275d60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10a3afbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10c2796d0>
          └ <fastapi.applications.FastAPI object at 0x10c275d60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10c289550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10c279730>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10c2796d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10c289550>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10c279760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10c279730>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c2895e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10c279280>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10c279760>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c2895e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10b16ddc0>
          └ <fastapi.routing.APIRoute object at 0x10c282160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c2895e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c292a30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10c27ca60>
          └ <fastapi.routing.APIRoute object at 0x10c282160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10c292670>
                     └ <function get_request_handler.<locals>.app at 0x10c27c9d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10b157d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('b55f8385-97f8-4831-a371-dfc725876b2f'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10c268550>
                 └ <fastapi.dependencies.models.Dependant object at 0x10c282250>

> File "./app/api/user.py", line 101, in login
    resp = redis_service.set_dep_key(key_name=user_id, key_value=failed_login_count, expires=90)
           │             │                    │                  └ 2
           │             │                    └ '3469911271959166976'
           │             └ <function RedisService.set_dep_key at 0x10b676f70>
           └ <utils.services.redis.redis_service.RedisService object at 0x10c186a90>

TypeError: set_dep_key() got an unexpected keyword argument 'expires'
2021-06-05  :38:06 - ERROR - user.py - 125 - An error has been caught in function 'login', process 'SpawnProcess-111' (7404), thread 'MainThread' (4463109568):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10a5d1430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10a47e280>
           └ <SpawnProcess name='SpawnProcess-111' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10a47a8b0>
    └ <SpawnProcess name='SpawnProcess-111' parent=3087 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10a6590a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-111' parent=3087 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-111' parent=3087 started>
    │    └ <function subprocess_started at 0x10a5f5ca0>
    └ <SpawnProcess name='SpawnProcess-111' parent=3087 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10a659040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10a5f4e50>
    │    │                  └ <uvicorn.server.Server object at 0x10a659040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10abdf700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10abdf670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10abe21f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10ab38550>
    └ <Handle <TaskStepMethWrapper object at 0x10ceadd60>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10ceadd60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10ceadd60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10ceadd60>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10b03f700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10b03f790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10afd6be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10ce990a0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10afd6be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10ce999d0>
          └ <fastapi.applications.FastAPI object at 0x10ce990a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10cea88b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10ce99a30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10ce999d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10cea88b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10ce99a60>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10ce99a30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10cea8940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10ce99580>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10ce99a60>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10cea8940>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10bd92dc0>
          └ <fastapi.routing.APIRoute object at 0x10cea3460>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10cea8940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10ceadd30>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10ce9ddc0>
          └ <fastapi.routing.APIRoute object at 0x10cea3460>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10cead970>
                     └ <function get_request_handler.<locals>.app at 0x10ce9dd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10bd7cd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('05fdba4d-b8d5-4d94-8516-b6cf2b5e9abe'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10ce8b8b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x10cea3550>

> File "./app/api/user.py", line 125, in login
    access_token = create_authtoken()
                   └ <function create_authtoken at 0x10c1dad30>

  File "./utils/services/base/base_func.py", line 47, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622839086, 'exp': 1623443886, 'scopes': ['open'], 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x10beb9580>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :54:12 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-7' (7652), thread 'MainThread' (4732708288):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10be54430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10bce1280>
           └ <SpawnProcess name='SpawnProcess-7' parent=7513 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10bcd38b0>
    └ <SpawnProcess name='SpawnProcess-7' parent=7513 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10bedb0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-7' parent=7513 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-7' parent=7513 started>
    │    └ <function subprocess_started at 0x10be77ca0>
    └ <SpawnProcess name='SpawnProcess-7' parent=7513 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10bedb040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10be76e50>
    │    │                  └ <uvicorn.server.Server object at 0x10bedb040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10c461700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10c461670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10c4641f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10c3ba550>
    └ <Handle <TaskStepMethWrapper object at 0x10e734d30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10e734d30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10e734d30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10e734d30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10c8bc700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10c8bc790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10c857be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10e720070>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10c857be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10e7209a0>
          └ <fastapi.applications.FastAPI object at 0x10e720070>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10e730820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10e720a00>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10e7209a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10e730820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10e720a30>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10e720a00>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10e7308b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10e720550>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10e720a30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10e7308b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10d615dc0>
          └ <fastapi.routing.APIRoute object at 0x10e72a430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10e7308b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10e734d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10e724d30>
          └ <fastapi.routing.APIRoute object at 0x10e72a430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10e734940>
                     └ <function get_request_handler.<locals>.app at 0x10e724ca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10d5ffd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('388f1ab3-bfd7-4c93-a9a7-b7eb1ec7d51c'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10e712820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10e72a520>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken()['access_token']
                   └ <function create_authtoken at 0x10da5dd30>

  File "./utils/services/base/base_func.py", line 47, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840052, 'exp': 1623444852, 'scopes': ['open'], 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x10d73c580>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :55:02 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-8' (7675), thread 'MainThread' (4688676288):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10ae0e430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10ac9b280>
           └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10ac8d8b0>
    └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10ae950a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
    │    └ <function subprocess_started at 0x10ae31ca0>
    └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10ae95040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10ae30e50>
    │    │                  └ <uvicorn.server.Server object at 0x10ae95040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10b41b700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10b41b670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10b41e1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10b374550>
    └ <Handle <TaskStepMethWrapper object at 0x10d6eecd0>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10d6eecd0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10d6eecd0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10d6eecd0>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10b876700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10b876790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10b811be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10d6d6fd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10b811be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10d6d9940>
          └ <fastapi.applications.FastAPI object at 0x10d6d6fd0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10d6ea820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10d6d99a0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10d6d9940>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10d6ea820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10d6d99d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10d6d99a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10d6ea8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10d6d94f0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10d6d99d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10d6ea8b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10c5cfdc0>
          └ <fastapi.routing.APIRoute object at 0x10d6e43d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10d6ea8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d6eeca0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10d6ddd30>
          └ <fastapi.routing.APIRoute object at 0x10d6e43d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10d6ee8e0>
                     └ <function get_request_handler.<locals>.app at 0x10d6ddca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10c5b9d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('520e0e74-f8c2-4828-bde9-71bff85c9be8'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10d6cb820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10d6e44c0>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken()['access_token']
                   └ <function create_authtoken at 0x10ca18d30>

  File "./utils/services/base/base_func.py", line 48, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840102, 'exp': 1623444902, 'scopes': ['open'], 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x10c6f5550>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :56:16 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-8' (7675), thread 'MainThread' (4688676288):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10ae0e430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10ac9b280>
           └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10ac8d8b0>
    └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10ae950a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
    │    └ <function subprocess_started at 0x10ae31ca0>
    └ <SpawnProcess name='SpawnProcess-8' parent=7513 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10ae95040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10ae30e50>
    │    │                  └ <uvicorn.server.Server object at 0x10ae95040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10b41b700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10b41b670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10b41e1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10b374550>
    └ <Handle <TaskStepMethWrapper object at 0x10d7e64f0>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10d7e64f0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10d7e64f0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10d7e64f0>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10b876700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10b876790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10b811be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10d6d6fd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10b811be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10d6d9940>
          └ <fastapi.applications.FastAPI object at 0x10d6d6fd0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10d6ea8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10d6d99a0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10d6d9940>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10d6ea8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10d6d99d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10d6d99a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10d6ea940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10d6d94f0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10d6d99d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10d6ea940>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10c5cfdc0>
          └ <fastapi.routing.APIRoute object at 0x10d6e43d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10d6ea940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10d7e6820>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10d6ddd30>
          └ <fastapi.routing.APIRoute object at 0x10d6e43d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10d7e6280>
                     └ <function get_request_handler.<locals>.app at 0x10d6ddca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10c5b9d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('72097881-002f-49fb-b373-07ad09b417c4'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10d6cb820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10d6e44c0>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken()['access_token']
                   └ <function create_authtoken at 0x10ca18d30>

  File "./utils/services/base/base_func.py", line 48, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840176, 'exp': 1623444976, 'scopes': ['open'], 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x10c6f5550>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :56:35 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-1' (7710), thread 'MainThread' (4491625920):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x108f37430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x108dc5280>
           └ <SpawnProcess name='SpawnProcess-1' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x108db78b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x108fbf0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=7708 started>
    │    └ <function subprocess_started at 0x108f5bca0>
    └ <SpawnProcess name='SpawnProcess-1' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x108fbf040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x108f5ae50>
    │    │                  └ <uvicorn.server.Server object at 0x108fbf040>
    │    └ <function BaseEventLoop.run_until_complete at 0x109545700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x109545670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1095471f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10949e550>
    └ <Handle <TaskStepMethWrapper object at 0x10b818d00>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10b818d00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10b818d00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10b818d00>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x1099a5700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x1099a5790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10993bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10b802040>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10993bbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10b802970>
          └ <fastapi.applications.FastAPI object at 0x10b802040>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10b814820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10b8029d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10b802970>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10b814820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10b802a00>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10b8029d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10b8148b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10b802520>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10b802a00>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10b8148b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10a6f9dc0>
          └ <fastapi.routing.APIRoute object at 0x10b80e400>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10b8148b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10b818cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10b806d30>
          └ <fastapi.routing.APIRoute object at 0x10b80e400>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10b818910>
                     └ <function get_request_handler.<locals>.app at 0x10b806ca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10a6e3d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('74db8c33-471f-4b06-b61d-ee2518893ae3'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10b7f4820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10b80e4f0>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken()['access_token']
                   └ <function create_authtoken at 0x10ab41d30>

  File "./utils/services/base/base_func.py", line 48, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840195, 'exp': 1623444995, 'scopes': ['open'], 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x10a81f550>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :58:16 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-3' (7730), thread 'MainThread' (4467299776):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x109b49430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x1099d6280>
           └ <SpawnProcess name='SpawnProcess-3' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1099d38b0>
    └ <SpawnProcess name='SpawnProcess-3' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x109bd00a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=7708 started>
    │    └ <function subprocess_started at 0x109b6cca0>
    └ <SpawnProcess name='SpawnProcess-3' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x109bd0040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x109b6be50>
    │    │                  └ <uvicorn.server.Server object at 0x109bd0040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10a156700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10a156670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10a1591f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10a0af550>
    └ <Handle <TaskStepMethWrapper object at 0x10c4e9d00>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10c4e9d00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10c4e9d00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10c4e9d00>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10a677700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10a677790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10a617be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10c4d5040>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10a617be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10c4d5970>
          └ <fastapi.applications.FastAPI object at 0x10c4d5040>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10c4e5820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10c4d59d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10c4d5970>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10c4e5820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10c4d5a00>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10c4d59d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c4e58b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10c4d5520>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10c4d5a00>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c4e58b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10b3b6dc0>
          └ <fastapi.routing.APIRoute object at 0x10c4df400>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10c4e58b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10c4e9cd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x10c4d9d30>
          └ <fastapi.routing.APIRoute object at 0x10c4df400>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10c4e9910>
                     └ <function get_request_handler.<locals>.app at 0x10c4d9ca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10b3a0d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('443ab637-5761-43b5-9dbf-1482cc242fa6'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x10c4c7820>
                 └ <fastapi.dependencies.models.Dependant object at 0x10c4df4f0>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken('bc-app')['access_token']
                   └ <function create_authtoken at 0x10b812d30>

TypeError: create_authtoken() takes 0 positional arguments but 1 was given
2021-06-05  :00:30 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-4' (7759), thread 'MainThread' (4722398656):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10da9a430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10d927280>
           └ <SpawnProcess name='SpawnProcess-4' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10d9198b0>
    └ <SpawnProcess name='SpawnProcess-4' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10db210a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=7708 started>
    │    └ <function subprocess_started at 0x10dabdca0>
    └ <SpawnProcess name='SpawnProcess-4' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10db21040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10dab6e50>
    │    │                  └ <uvicorn.server.Server object at 0x10db21040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10e0a7700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10e0a7670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10e0aa1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10e000550>
    └ <Handle <TaskStepMethWrapper object at 0x11037ad30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x11037ad30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x11037ad30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x11037ad30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10e502700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10e502790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10e49ebe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x110365070>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10e49ebe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1103659a0>
          └ <fastapi.applications.FastAPI object at 0x110365070>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110376820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x110365a00>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1103659a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110376820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x110365a30>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x110365a00>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1103768b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x110365550>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x110365a30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1103768b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10f25bdc0>
          └ <fastapi.routing.APIRoute object at 0x110370430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1103768b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x11037ad00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x110369d30>
          └ <fastapi.routing.APIRoute object at 0x110370430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x11037a940>
                     └ <function get_request_handler.<locals>.app at 0x110369ca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10f245d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('515d1aa7-0816-4419-84be-1964bbb8c684'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x110357820>
                 └ <fastapi.dependencies.models.Dependant object at 0x110370520>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken('bc-app')['access_token']
                   └ <function create_authtoken at 0x10f6a4d30>

  File "./utils/services/base/base_func.py", line 49, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840430, 'exp': 1623445230, 'scopes': ['open'], 'user_id': 'bc-app', 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x10f37e550>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :00:56 - ERROR - user.py - 123 - An error has been caught in function 'login', process 'SpawnProcess-5' (7767), thread 'MainThread' (4475934144):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x102dff430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x102c8c280>
           └ <SpawnProcess name='SpawnProcess-5' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102c7e8b0>
    └ <SpawnProcess name='SpawnProcess-5' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x102e860a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=7708 started>
    │    └ <function subprocess_started at 0x102e22ca0>
    └ <SpawnProcess name='SpawnProcess-5' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x102e86040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x102e21e50>
    │    │                  └ <uvicorn.server.Server object at 0x102e86040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10340c700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10340c670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10340e1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103365550>
    └ <Handle <TaskStepMethWrapper object at 0x1056dfd30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1056dfd30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1056dfd30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1056dfd30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x10386c700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x10386c790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103802be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1056cb070>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103802be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1056cb9a0>
          └ <fastapi.applications.FastAPI object at 0x1056cb070>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1056db820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1056cba00>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1056cb9a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1056db820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x1056cba30>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1056cba00>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1056db8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1056cb550>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x1056cba30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1056db8b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x1045c0dc0>
          └ <fastapi.routing.APIRoute object at 0x1056d5430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1056db8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1056dfd00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1056cfd30>
          └ <fastapi.routing.APIRoute object at 0x1056d5430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1056df940>
                     └ <function get_request_handler.<locals>.app at 0x1056cfca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1045aad30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('2099d49f-be81-46a4-975e-a7bacda68c93'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x1056bd820>
                 └ <fastapi.dependencies.models.Dependant object at 0x1056d5520>

> File "./app/api/user.py", line 123, in login
    access_token = create_authtoken('bc-app')
                   └ <function create_authtoken at 0x104a08d30>

  File "./utils/services/base/base_func.py", line 49, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840456, 'exp': 1623445256, 'scopes': ['open'], 'user_id': 'bc-app', 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x1046e8550>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :03:17 - ERROR - user.py - 124 - An error has been caught in function 'login', process 'SpawnProcess-6' (7792), thread 'MainThread' (4537611712):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10672f430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x1065bd280>
           └ <SpawnProcess name='SpawnProcess-6' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1065ba8b0>
    └ <SpawnProcess name='SpawnProcess-6' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1067b70a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-6' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-6' parent=7708 started>
    │    └ <function subprocess_started at 0x106753ca0>
    └ <SpawnProcess name='SpawnProcess-6' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1067b7040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x106752e50>
    │    │                  └ <uvicorn.server.Server object at 0x1067b7040>
    │    └ <function BaseEventLoop.run_until_complete at 0x106d3d700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x106d3d670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x106d3f1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x106c96550>
    └ <Handle <TaskStepMethWrapper object at 0x109010d30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x109010d30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x109010d30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x109010d30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x107198700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x107198790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x107134be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x108ffc070>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x107134be0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x108ffc9a0>
          └ <fastapi.applications.FastAPI object at 0x108ffc070>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10900b8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x108ffca00>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x108ffc9a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10900b8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x108ffca30>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x108ffca00>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10900b940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x108ffc550>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x108ffca30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10900b940>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x107ef1dc0>
          └ <fastapi.routing.APIRoute object at 0x109006430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10900b940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x109010d00>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x109001dc0>
          └ <fastapi.routing.APIRoute object at 0x109006430>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x109010940>
                     └ <function get_request_handler.<locals>.app at 0x109001d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x107edbd30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'user_info': UserLogin(id=UUID('ad99222a-f2e6-426e-aba2-4b1f370bac6c'), email='wkaifeng2007@163.com', is_active=True, is_sup...
                 │         └ <function login at 0x108fee8b0>
                 └ <fastapi.dependencies.models.Dependant object at 0x109006520>

> File "./app/api/user.py", line 124, in login
    access_token = create_authtoken(user_id=user_id, identity='bc-app')['access_token']
                   │                        └ '3469911271959166976'
                   └ <function create_authtoken at 0x108339d30>

  File "./utils/services/base/base_func.py", line 48, in create_authtoken
    token = jwt.encode(payload, CONFIG['SALT'], algorithm='HS256').decode('utf-8')
            │   │      │        └ {'IDENTITY': ['bc-app', 'bc-web'], 'SALT': '795542400000'}
            │   │      └ {'iat': 1622840597, 'exp': 1623445397, 'scopes': ['open'], 'user_id': '3469911271959166976', 'identity': 'bc-app'}
            │   └ <bound method PyJWT.encode of <jwt.api_jwt.PyJWT object at 0x108018580>>
            └ <module 'jwt' from '/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/jwt/__init__.py'>

AttributeError: 'str' object has no attribute 'decode'
2021-06-05  :53:04 - ERROR - auth.py - 41 - An error has been caught in function 'verify_request', process 'SpawnProcess-24' (8262), thread 'MainThread' (4511548864):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x107578430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x107405280>
           └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1073f78b0>
    └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1075ff0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
    │    └ <function subprocess_started at 0x10759bca0>
    └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1075ff040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10759ae50>
    │    │                  └ <uvicorn.server.Server object at 0x1075ff040>
    │    └ <function BaseEventLoop.run_until_complete at 0x107b85700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x107b85670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x107b881f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x107ade550>
    └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 57, in serve
    config.load()
    │      └ <function Config.load at 0x107da71f0>
    └ <uvicorn.config.Config object at 0x1075ff0a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/config.py", line 318, in load
    self.loaded_app = import_from_string(self.app)
    │                 │                  │    └ 'main:app'
    │                 │                  └ <uvicorn.config.Config object at 0x1075ff0a0>
    │                 └ <function import_from_string at 0x107d3c1f0>
    └ <uvicorn.config.Config object at 0x1075ff0a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 22, in import_from_string
    module = importlib.import_module(module_str)
             │         │             └ 'main'
             │         └ <function import_module at 0x107509b80>
             └ <module 'importlib' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           │          │           │    │        │        └ 0
           │          │           │    │        └ None
           │          │           │    └ 0
           │          │           └ 'main'
           │          └ <function _gcd_import at 0x10716c430>
           └ <module 'importlib._bootstrap' (frozen)>
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./main.py", line 3, in <module>
    from app.api.user import router as user_router

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./app/api/user.py", line 135, in <module>
    async def logout(user_info: UserLogout, dep: Depends(antx_auth(Request, 'bc-app'))):
                                │                │       │         └ <class 'starlette.requests.Request'>
                                │                │       └ <function antx_auth at 0x109947700>
                                │                └ <function Depends at 0x108d03ca0>
                                └ <class 'app.models.user_models.UserLogout'>

  File "./utils/services/base/base_func.py", line 51, in antx_auth
    return auth_required(request=request, db=db)
           │                     │           └ 'bc-app'
           │                     └ <class 'starlette.requests.Request'>
           └ <function auth_required at 0x10993d790>

  File "./utils/services/auth/antx_auth.py", line 27, in auth_required
    status, auth_token = Auth.verify_request(request)
                         │    │              └ <class 'starlette.requests.Request'>
                         │    └ <function verify_request at 0x108ef89d0>
                         └ <module 'utils.services.auth.auth' from './utils/services/auth/auth.py'>

> File "./utils/services/auth/auth.py", line 41, in verify_request
    authorization_type, token = get_authorization(request)
                                │                 └ <class 'starlette.requests.Request'>
                                └ <function get_authorization at 0x108ef8310>

  File "./utils/services/auth/auth.py", line 20, in get_authorization
    authorization = request.headers.get('Authorization')
                    │       └ <property object at 0x108cb5360>
                    └ <class 'starlette.requests.Request'>

AttributeError: 'property' object has no attribute 'get'
2021-06-05  :53:04 - ERROR - antx_auth.py - 27 - An error has been caught in function 'auth_required', process 'SpawnProcess-24' (8262), thread 'MainThread' (4511548864):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x107578430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x107405280>
           └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1073f78b0>
    └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1075ff0a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
    │    └ <function subprocess_started at 0x10759bca0>
    └ <SpawnProcess name='SpawnProcess-24' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1075ff040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10759ae50>
    │    │                  └ <uvicorn.server.Server object at 0x1075ff040>
    │    └ <function BaseEventLoop.run_until_complete at 0x107b85700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x107b85670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x107b881f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x107ade550>
    └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x107f92d30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 57, in serve
    config.load()
    │      └ <function Config.load at 0x107da71f0>
    └ <uvicorn.config.Config object at 0x1075ff0a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/config.py", line 318, in load
    self.loaded_app = import_from_string(self.app)
    │                 │                  │    └ 'main:app'
    │                 │                  └ <uvicorn.config.Config object at 0x1075ff0a0>
    │                 └ <function import_from_string at 0x107d3c1f0>
    └ <uvicorn.config.Config object at 0x1075ff0a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 22, in import_from_string
    module = importlib.import_module(module_str)
             │         │             └ 'main'
             │         └ <function import_module at 0x107509b80>
             └ <module 'importlib' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           │          │           │    │        │        └ 0
           │          │           │    │        └ None
           │          │           │    └ 0
           │          │           └ 'main'
           │          └ <function _gcd_import at 0x10716c430>
           └ <module 'importlib._bootstrap' (frozen)>
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./main.py", line 3, in <module>
    from app.api.user import router as user_router

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./app/api/user.py", line 135, in <module>
    async def logout(user_info: UserLogout, dep: Depends(antx_auth(Request, 'bc-app'))):
                                │                │       │         └ <class 'starlette.requests.Request'>
                                │                │       └ <function antx_auth at 0x109947700>
                                │                └ <function Depends at 0x108d03ca0>
                                └ <class 'app.models.user_models.UserLogout'>

  File "./utils/services/base/base_func.py", line 51, in antx_auth
    return auth_required(request=request, db=db)
           │                     │           └ 'bc-app'
           │                     └ <class 'starlette.requests.Request'>
           └ <function auth_required at 0x10993d790>

> File "./utils/services/auth/antx_auth.py", line 27, in auth_required
    status, auth_token = Auth.verify_request(request)
                         │    │              └ <class 'starlette.requests.Request'>
                         │    └ <function verify_request at 0x108ef89d0>
                         └ <module 'utils.services.auth.auth' from './utils/services/auth/auth.py'>

  File "./utils/services/auth/auth.py", line 41, in verify_request
    authorization_type, token = get_authorization(request)
                                │                 └ <class 'starlette.requests.Request'>
                                └ <function get_authorization at 0x108ef8310>

TypeError: cannot unpack non-iterable NoneType object
2021-06-05  :55:15 - ERROR - auth.py - 41 - An error has been caught in function 'verify_request', process 'SpawnProcess-26' (8294), thread 'MainThread' (4619638208):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x106ddf430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x106c6c280>
           └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x106c5e8b0>
    └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x106e660a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
    │    └ <function subprocess_started at 0x106e02ca0>
    └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x106e66040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x106e01e50>
    │    │                  └ <uvicorn.server.Server object at 0x106e66040>
    │    └ <function BaseEventLoop.run_until_complete at 0x1073ec700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1073ec670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1073ef1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x107345550>
    └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 57, in serve
    config.load()
    │      └ <function Config.load at 0x10760e1f0>
    └ <uvicorn.config.Config object at 0x106e660a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/config.py", line 318, in load
    self.loaded_app = import_from_string(self.app)
    │                 │                  │    └ 'main:app'
    │                 │                  └ <uvicorn.config.Config object at 0x106e660a0>
    │                 └ <function import_from_string at 0x1075a31f0>
    └ <uvicorn.config.Config object at 0x106e660a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 22, in import_from_string
    module = importlib.import_module(module_str)
             │         │             └ 'main'
             │         └ <function import_module at 0x106d70b80>
             └ <module 'importlib' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           │          │           │    │        │        └ 0
           │          │           │    │        └ None
           │          │           │    └ 0
           │          │           └ 'main'
           │          └ <function _gcd_import at 0x1069d3430>
           └ <module 'importlib._bootstrap' (frozen)>
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./main.py", line 3, in <module>
    from app.api.user import router as user_router

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./app/api/user.py", line 135, in <module>
    async def logout(user_info: UserLogout, dep: Depends(antx_auth(Request, 'bc-app'))):
                                │                │       │         └ <class 'starlette.requests.Request'>
                                │                │       └ <function antx_auth at 0x1091ae700>
                                │                └ <function Depends at 0x10856aca0>
                                └ <class 'app.models.user_models.UserLogout'>

  File "./utils/services/base/base_func.py", line 51, in antx_auth
    return auth_required(request=request, db=db)
           │                     │           └ 'bc-app'
           │                     └ <class 'starlette.requests.Request'>
           └ <function auth_required at 0x1091a4790>

  File "./utils/services/auth/antx_auth.py", line 27, in auth_required
    status, auth_token = Auth.verify_request(request)
                         │    │              └ <class 'starlette.requests.Request'>
                         │    └ <function verify_request at 0x10875f9d0>
                         └ <module 'utils.services.auth.auth' from './utils/services/auth/auth.py'>

> File "./utils/services/auth/auth.py", line 41, in verify_request
    authorization_type, token = get_authorization(request)
                                │                 └ <class 'starlette.requests.Request'>
                                └ <function get_authorization at 0x10875f310>

  File "./utils/services/auth/auth.py", line 20, in get_authorization
    authorization = request.headers.get('Authorization')
                    │       └ <property object at 0x10851c360>
                    └ <class 'starlette.requests.Request'>

AttributeError: 'property' object has no attribute 'get'
2021-06-05  :55:15 - ERROR - antx_auth.py - 27 - An error has been caught in function 'auth_required', process 'SpawnProcess-26' (8294), thread 'MainThread' (4619638208):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x106ddf430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x106c6c280>
           └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x106c5e8b0>
    └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x106e660a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
    │    └ <function subprocess_started at 0x106e02ca0>
    └ <SpawnProcess name='SpawnProcess-26' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x106e66040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x106e01e50>
    │    │                  └ <uvicorn.server.Server object at 0x106e66040>
    │    └ <function BaseEventLoop.run_until_complete at 0x1073ec700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1073ec670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1073ef1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x107345550>
    └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1077fad30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 57, in serve
    config.load()
    │      └ <function Config.load at 0x10760e1f0>
    └ <uvicorn.config.Config object at 0x106e660a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/config.py", line 318, in load
    self.loaded_app = import_from_string(self.app)
    │                 │                  │    └ 'main:app'
    │                 │                  └ <uvicorn.config.Config object at 0x106e660a0>
    │                 └ <function import_from_string at 0x1075a31f0>
    └ <uvicorn.config.Config object at 0x106e660a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 22, in import_from_string
    module = importlib.import_module(module_str)
             │         │             └ 'main'
             │         └ <function import_module at 0x106d70b80>
             └ <module 'importlib' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           │          │           │    │        │        └ 0
           │          │           │    │        └ None
           │          │           │    └ 0
           │          │           └ 'main'
           │          └ <function _gcd_import at 0x1069d3430>
           └ <module 'importlib._bootstrap' (frozen)>
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./main.py", line 3, in <module>
    from app.api.user import router as user_router

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./app/api/user.py", line 135, in <module>
    async def logout(user_info: UserLogout, dep: Depends(antx_auth(Request, 'bc-app'))):
                                │                │       │         └ <class 'starlette.requests.Request'>
                                │                │       └ <function antx_auth at 0x1091ae700>
                                │                └ <function Depends at 0x10856aca0>
                                └ <class 'app.models.user_models.UserLogout'>

  File "./utils/services/base/base_func.py", line 51, in antx_auth
    return auth_required(request=request, db=db)
           │                     │           └ 'bc-app'
           │                     └ <class 'starlette.requests.Request'>
           └ <function auth_required at 0x1091a4790>

> File "./utils/services/auth/antx_auth.py", line 27, in auth_required
    status, auth_token = Auth.verify_request(request)
                         │    │              └ <class 'starlette.requests.Request'>
                         │    └ <function verify_request at 0x10875f9d0>
                         └ <module 'utils.services.auth.auth' from './utils/services/auth/auth.py'>

  File "./utils/services/auth/auth.py", line 41, in verify_request
    authorization_type, token = get_authorization(request)
                                │                 └ <class 'starlette.requests.Request'>
                                └ <function get_authorization at 0x10875f310>

TypeError: cannot unpack non-iterable NoneType object
2021-06-05  :07:11 - ERROR - auth.py - 41 - An error has been caught in function 'verify_request', process 'SpawnProcess-36' (8405), thread 'MainThread' (4581389760):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10ed7b430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10ec08280>
           └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10ebfa8b0>
    └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10ee020a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
    │    └ <function subprocess_started at 0x10ed9eca0>
    └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10ee02040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10ed90e50>
    │    │                  └ <uvicorn.server.Server object at 0x10ee02040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10f388700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10f388670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10f38b1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10f2e1550>
    └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 57, in serve
    config.load()
    │      └ <function Config.load at 0x10f5aa1f0>
    └ <uvicorn.config.Config object at 0x10ee020a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/config.py", line 318, in load
    self.loaded_app = import_from_string(self.app)
    │                 │                  │    └ 'main:app'
    │                 │                  └ <uvicorn.config.Config object at 0x10ee020a0>
    │                 └ <function import_from_string at 0x10f53f1f0>
    └ <uvicorn.config.Config object at 0x10ee020a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 22, in import_from_string
    module = importlib.import_module(module_str)
             │         │             └ 'main'
             │         └ <function import_module at 0x10ed0cb80>
             └ <module 'importlib' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           │          │           │    │        │        └ 0
           │          │           │    │        └ None
           │          │           │    └ 0
           │          │           └ 'main'
           │          └ <function _gcd_import at 0x10e96f430>
           └ <module 'importlib._bootstrap' (frozen)>
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./main.py", line 3, in <module>
    from app.api.user import router as user_router

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./app/api/user.py", line 146, in <module>
    async def logout(user_info: UserLogout, dep=Depends(antx_auth(request=Request, db='bc-app'))):
                                │               │       │                 └ <class 'starlette.requests.Request'>
                                │               │       └ <function antx_auth at 0x111218700>
                                │               └ <function Depends at 0x110506ca0>
                                └ <class 'app.models.user_models.UserLogout'>

  File "./utils/services/base/base_func.py", line 51, in antx_auth
    return auth_required(request=request, db=db)
           │                     │           └ 'bc-app'
           │                     └ <class 'starlette.requests.Request'>
           └ <function auth_required at 0x11120e790>

  File "./utils/services/auth/antx_auth.py", line 27, in auth_required
    status, auth_token = Auth.verify_request(request)
                         │    │              └ <class 'starlette.requests.Request'>
                         │    └ <function verify_request at 0x1106fb9d0>
                         └ <module 'utils.services.auth.auth' from './utils/services/auth/auth.py'>

> File "./utils/services/auth/auth.py", line 41, in verify_request
    authorization_type, token = get_authorization(request)
                                │                 └ <class 'starlette.requests.Request'>
                                └ <function get_authorization at 0x1106fb310>

  File "./utils/services/auth/auth.py", line 20, in get_authorization
    authorization = request.headers.get('Authorization')
                    │       └ <property object at 0x1104b82c0>
                    └ <class 'starlette.requests.Request'>

AttributeError: 'property' object has no attribute 'get'
2021-06-05  :07:11 - ERROR - antx_auth.py - 27 - An error has been caught in function 'auth_required', process 'SpawnProcess-36' (8405), thread 'MainThread' (4581389760):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10ed7b430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x10ec08280>
           └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10ebfa8b0>
    └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10ee020a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
    │    └ <function subprocess_started at 0x10ed9eca0>
    └ <SpawnProcess name='SpawnProcess-36' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10ee02040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x10ed90e50>
    │    │                  └ <uvicorn.server.Server object at 0x10ee02040>
    │    └ <function BaseEventLoop.run_until_complete at 0x10f388700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10f388670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10f38b1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10f2e1550>
    └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10f795d30>()>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 57, in serve
    config.load()
    │      └ <function Config.load at 0x10f5aa1f0>
    └ <uvicorn.config.Config object at 0x10ee020a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/config.py", line 318, in load
    self.loaded_app = import_from_string(self.app)
    │                 │                  │    └ 'main:app'
    │                 │                  └ <uvicorn.config.Config object at 0x10ee020a0>
    │                 └ <function import_from_string at 0x10f53f1f0>
    └ <uvicorn.config.Config object at 0x10ee020a0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 22, in import_from_string
    module = importlib.import_module(module_str)
             │         │             └ 'main'
             │         └ <function import_module at 0x10ed0cb80>
             └ <module 'importlib' from '/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           │          │           │    │        │        └ 0
           │          │           │    │        └ None
           │          │           │    └ 0
           │          │           └ 'main'
           │          └ <function _gcd_import at 0x10e96f430>
           └ <module 'importlib._bootstrap' (frozen)>
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./main.py", line 3, in <module>
    from app.api.user import router as user_router

  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed

  File "./app/api/user.py", line 146, in <module>
    async def logout(user_info: UserLogout, dep=Depends(antx_auth(request=Request, db='bc-app'))):
                                │               │       │                 └ <class 'starlette.requests.Request'>
                                │               │       └ <function antx_auth at 0x111218700>
                                │               └ <function Depends at 0x110506ca0>
                                └ <class 'app.models.user_models.UserLogout'>

  File "./utils/services/base/base_func.py", line 51, in antx_auth
    return auth_required(request=request, db=db)
           │                     │           └ 'bc-app'
           │                     └ <class 'starlette.requests.Request'>
           └ <function auth_required at 0x11120e790>

> File "./utils/services/auth/antx_auth.py", line 27, in auth_required
    status, auth_token = Auth.verify_request(request)
                         │    │              └ <class 'starlette.requests.Request'>
                         │    └ <function verify_request at 0x1106fb9d0>
                         └ <module 'utils.services.auth.auth' from './utils/services/auth/auth.py'>

  File "./utils/services/auth/auth.py", line 41, in verify_request
    authorization_type, token = get_authorization(request)
                                │                 └ <class 'starlette.requests.Request'>
                                └ <function get_authorization at 0x1106fb310>

TypeError: cannot unpack non-iterable NoneType object
2021-06-05  :08:50 - ERROR - user.py - 158 - An error has been caught in function 'forgot_password', process 'SpawnProcess-52' (8998), thread 'MainThread' (4330194368):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10170a430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x101597280>
           └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1015898b0>
    └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1017910a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
    │    └ <function subprocess_started at 0x10172dca0>
    └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101791040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x101726e50>
    │    │                  └ <uvicorn.server.Server object at 0x101791040>
    │    └ <function BaseEventLoop.run_until_complete at 0x101d17700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101d17670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101d1a1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101c70550>
    └ <Handle <TaskWakeupMethWrapper object at 0x1040cbc70>(<Future finis...405556051968'>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x1040cbc70>(<Future finis...405556051968'>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x1040cbc70>(<Future finis...405556051968'>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x1040cbc70>(<Future finis...405556051968'>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x102244700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x102244790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1021dfbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1040a06d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1021dfbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1040a9160>
          └ <fastapi.applications.FastAPI object at 0x1040a06d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1040b5940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1040a9130>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1040a9160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1040b5940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x1040a9040>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1040a9130>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1040f1e50>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1040a0bb0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x1040a9040>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1040f1e50>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x102f9ddc0>
          └ <fastapi.routing.APIRoute object at 0x1040b2280>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1040f1e50>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1040cbeb0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1040b5040>
          └ <fastapi.routing.APIRoute object at 0x1040b2280>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1040cbbb0>
                     └ <function get_request_handler.<locals>.app at 0x1040a3ee0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102f87d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'dep': '3470044405556051968', 'user_info': UserResetPassword(id=UUID('c66ab6bc-0d69-4e30-bca7-81130a962cc5'), email=None, is...
                 │         └ <function forgot_password at 0x104099160>
                 └ <fastapi.dependencies.models.Dependant object at 0x1040b2370>

> File "./app/api/user.py", line 158, in forgot_password
    user_id = mongodb.find_one({''})
              │       └ <function MongoDB.find_one at 0x103b7edc0>
              └ <utils.services.db.mongodb.MongoDB object at 0x10300ad30>

  File "./utils/services/db/mongodb.py", line 81, in find_one
    return self.collection.find_one(data_dict, {'_id':0})
           │    │          │        └ {''}
           │    │          └ <function Collection.find_one at 0x1036f63a0>
           │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'us...
           └ <utils.services.db.mongodb.MongoDB object at 0x10300ad30>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1319, in find_one
    for result in cursor.limit(-1):
                  │      └ <function Cursor.limit at 0x1036df9d0>
                  └ <pymongo.cursor.Cursor object at 0x1040cbca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 1207, in next
    if len(self.__data) or self._refresh():
           │               │    └ <function Cursor._refresh at 0x1036e15e0>
           │               └ <pymongo.cursor.Cursor object at 0x1040cbca0>
           └ <pymongo.cursor.Cursor object at 0x1040cbca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 1124, in _refresh
    self.__send_message(q)
    │                   └ <pymongo.message._Query object at 0x104117b40>
    └ <pymongo.cursor.Cursor object at 0x1040cbca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 999, in __send_message
    response = client._run_operation_with_response(
               │      └ <function MongoClient._run_operation_with_response at 0x1037f2c10>
               └ MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1368, in _run_operation_with_response
    return self._retryable_read(
           │    └ <function MongoClient._retryable_read at 0x1037f2dc0>
           └ MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1471, in _retryable_read
    return func(session, server, sock_info, slave_ok)
           │    │        │       │          └ True
           │    │        │       └ SocketInfo(<socket.socket fd=59, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 6189...
           │    │        └ <Server <ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0008356120000002677>>
           │    └ <pymongo.client_session.ClientSession object at 0x1040cbac0>
           └ <function MongoClient._run_operation_with_response.<locals>._cmd at 0x1040f1ee0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1360, in _cmd
    return server.run_operation_with_response(
           │      └ <function Server.run_operation_with_response at 0x1037e7f70>
           └ <Server <ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0008356120000002677>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/server.py", line 101, in run_operation_with_response
    message = operation.get_message(
              │         └ <function _Query.get_message at 0x1036899d0>
              └ <pymongo.message._Query object at 0x104117b40>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/message.py", line 343, in get_message
    request_id, msg, size, _ = _op_msg(
                               └ <function _op_msg at 0x103694820>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/message.py", line 714, in _op_msg
    return _op_msg_uncompressed(
           └ <built-in function _op_msg>

bson.errors.InvalidDocument: cannot encode object: {''}, of type: <class 'set'>
2021-06-05  :10:36 - ERROR - user.py - 158 - An error has been caught in function 'forgot_password', process 'SpawnProcess-52' (8998), thread 'MainThread' (4330194368):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x10170a430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x101597280>
           └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1015898b0>
    └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1017910a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
    │    └ <function subprocess_started at 0x10172dca0>
    └ <SpawnProcess name='SpawnProcess-52' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101791040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x101726e50>
    │    │                  └ <uvicorn.server.Server object at 0x101791040>
    │    └ <function BaseEventLoop.run_until_complete at 0x101d17700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101d17670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101d1a1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101c70550>
    └ <Handle <TaskWakeupMethWrapper object at 0x10413aa60>(<Future finis...405556051968'>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x10413aa60>(<Future finis...405556051968'>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x10413aa60>(<Future finis...405556051968'>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x10413aa60>(<Future finis...405556051968'>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x102244700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x102244790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1021dfbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1040a06d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1021dfbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1040a9160>
          └ <fastapi.applications.FastAPI object at 0x1040a06d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1040f1e50>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1040a9130>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1040a9160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1040f1e50>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x1040a9040>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1040a9130>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1040f1ee0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1040a0bb0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x1040a9040>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1040f1ee0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x102f9ddc0>
          └ <fastapi.routing.APIRoute object at 0x1040b2280>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1040f1ee0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x10413a550>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x1040b5040>
          └ <fastapi.routing.APIRoute object at 0x1040b2280>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10413a400>
                     └ <function get_request_handler.<locals>.app at 0x1040a3ee0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102f87d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'dep': '3470044405556051968', 'user_info': UserResetPassword(id=UUID('db39c8f6-1970-4c69-bb3e-d98e4f7c777f'), email=None, is...
                 │         └ <function forgot_password at 0x104099160>
                 └ <fastapi.dependencies.models.Dependant object at 0x1040b2370>

> File "./app/api/user.py", line 158, in forgot_password
    user_id = mongodb.find_one({''})
              │       └ <function MongoDB.find_one at 0x103b7edc0>
              └ <utils.services.db.mongodb.MongoDB object at 0x10300ad30>

  File "./utils/services/db/mongodb.py", line 81, in find_one
    return self.collection.find_one(data_dict, {'_id':0})
           │    │          │        └ {''}
           │    │          └ <function Collection.find_one at 0x1036f63a0>
           │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'us...
           └ <utils.services.db.mongodb.MongoDB object at 0x10300ad30>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1319, in find_one
    for result in cursor.limit(-1):
                  │      └ <function Cursor.limit at 0x1036df9d0>
                  └ <pymongo.cursor.Cursor object at 0x1040cbc70>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 1207, in next
    if len(self.__data) or self._refresh():
           │               │    └ <function Cursor._refresh at 0x1036e15e0>
           │               └ <pymongo.cursor.Cursor object at 0x1040cbc70>
           └ <pymongo.cursor.Cursor object at 0x1040cbc70>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 1124, in _refresh
    self.__send_message(q)
    │                   └ <pymongo.message._Query object at 0x104138b40>
    └ <pymongo.cursor.Cursor object at 0x1040cbc70>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 999, in __send_message
    response = client._run_operation_with_response(
               │      └ <function MongoClient._run_operation_with_response at 0x1037f2c10>
               └ MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1368, in _run_operation_with_response
    return self._retryable_read(
           │    └ <function MongoClient._retryable_read at 0x1037f2dc0>
           └ MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1471, in _retryable_read
    return func(session, server, sock_info, slave_ok)
           │    │        │       │          └ True
           │    │        │       └ SocketInfo(<socket.socket fd=59, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 6189...
           │    │        └ <Server <ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0007765506746561873>>
           │    └ <pymongo.client_session.ClientSession object at 0x1042522b0>
           └ <function MongoClient._run_operation_with_response.<locals>._cmd at 0x1040f1ca0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1360, in _cmd
    return server.run_operation_with_response(
           │      └ <function Server.run_operation_with_response at 0x1037e7f70>
           └ <Server <ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0007765506746561873>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/server.py", line 101, in run_operation_with_response
    message = operation.get_message(
              │         └ <function _Query.get_message at 0x1036899d0>
              └ <pymongo.message._Query object at 0x104138b40>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/message.py", line 343, in get_message
    request_id, msg, size, _ = _op_msg(
                               └ <function _op_msg at 0x103694820>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/message.py", line 714, in _op_msg
    return _op_msg_uncompressed(
           └ <built-in function _op_msg>

bson.errors.InvalidDocument: cannot encode object: {''}, of type: <class 'set'>
2021-06-05  :12:12 - ERROR - user.py - 158 - An error has been caught in function 'forgot_password', process 'SpawnProcess-53' (9024), thread 'MainThread' (4575561152):
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 8
               └ <function _main at 0x103dbc430>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x103c49280>
           └ <SpawnProcess name='SpawnProcess-53' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x103c468b0>
    └ <SpawnProcess name='SpawnProcess-53' parent=7708 started>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x103e430a0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-53' parent=7708 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-53' parent=7708 started>
    │    └ <function subprocess_started at 0x103ddfca0>
    └ <SpawnProcess name='SpawnProcess-53' parent=7708 started>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x103e43040>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/server.py", line 50, in run
    loop.run_until_complete(self.serve(sockets=sockets))
    │    │                  │    │             └ [<socket.socket fd=4, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8888)>]
    │    │                  │    └ <function Server.serve at 0x103ddee50>
    │    │                  └ <uvicorn.server.Server object at 0x103e43040>
    │    └ <function BaseEventLoop.run_until_complete at 0x1043c9700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1043c9670>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1043cc1f0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104322550>
    └ <Handle <TaskWakeupMethWrapper object at 0x106727610>(<Future finis...405556051968'>)>
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/asyncio/events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x106727610>(<Future finis...405556051968'>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x106727610>(<Future finis...405556051968'>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x106727610>(<Future finis...405556051968'>)>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/protocols/http/h11_impl.py", line 369, in run_asgi
    result = await app(self.scope, self.receive, self.send)
                   │   │    │      │    │        │    └ <function RequestResponseCycle.send at 0x104827700>
                   │   │    │      │    │        └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>
                   │   │    │      │    └ <function RequestResponseCycle.receive at 0x104827790>
                   │   │    │      └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>
                   │   │    └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                   │   └ <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1047bfbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/uvicorn/middleware/proxy_headers.py", line 59, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1066846d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1047bfbe0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/applications.py", line 199, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10668d160>
          └ <fastapi.applications.FastAPI object at 0x1066846d0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/errors.py", line 159, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106699820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10668d130>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10668d160>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/middleware/cors.py", line 78, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106699820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <starlette.exceptions.ExceptionMiddleware object at 0x10668d040>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10668d130>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/exceptions.py", line 71, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106699940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x106684bb0>
          └ <starlette.exceptions.ExceptionMiddleware object at 0x10668d040>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 580, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106699940>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │     └ <function Route.handle at 0x10557ddc0>
          └ <fastapi.routing.APIRoute object at 0x106696280>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 241, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106699940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x1067273d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.1'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8888), 'cl...
          │    └ <function request_response.<locals>.app at 0x106699040>
          └ <fastapi.routing.APIRoute object at 0x106696280>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/starlette/routing.py", line 52, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x106727460>
                     └ <function get_request_handler.<locals>.app at 0x106687ee0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 201, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105567d30>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/fastapi/routing.py", line 148, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'dep': '3470044405556051968', 'user_info': UserResetPassword(id=UUID('ae4170a8-b454-4817-89ea-b43f952637aa'), email=None, is...
                 │         └ <function forgot_password at 0x10667d160>
                 └ <fastapi.dependencies.models.Dependant object at 0x106696370>

> File "./app/api/user.py", line 158, in forgot_password
    user_id = mongodb.find_one({''})
              │       └ <function MongoDB.find_one at 0x106161dc0>
              └ <utils.services.db.mongodb.MongoDB object at 0x1055ead30>

  File "./utils/services/db/mongodb.py", line 81, in find_one
    return self.collection.find_one(data_dict, {'_id':0})
           │    │          │        └ {''}
           │    │          └ <function Collection.find_one at 0x105cda3a0>
           │    └ Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False), 'bc-app'), 'us...
           └ <utils.services.db.mongodb.MongoDB object at 0x1055ead30>

  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/collection.py", line 1319, in find_one
    for result in cursor.limit(-1):
                  │      └ <function Cursor.limit at 0x105cc39d0>
                  └ <pymongo.cursor.Cursor object at 0x1066aeb20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 1207, in next
    if len(self.__data) or self._refresh():
           │               │    └ <function Cursor._refresh at 0x105cc55e0>
           │               └ <pymongo.cursor.Cursor object at 0x1066aeb20>
           └ <pymongo.cursor.Cursor object at 0x1066aeb20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 1124, in _refresh
    self.__send_message(q)
    │                   └ <pymongo.message._Query object at 0x106728510>
    └ <pymongo.cursor.Cursor object at 0x1066aeb20>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/cursor.py", line 999, in __send_message
    response = client._run_operation_with_response(
               │      └ <function MongoClient._run_operation_with_response at 0x105dd5c10>
               └ MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1368, in _run_operation_with_response
    return self._retryable_read(
           │    └ <function MongoClient._retryable_read at 0x105dd5dc0>
           └ MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=False)
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1471, in _retryable_read
    return func(session, server, sock_info, slave_ok)
           │    │        │       │          └ True
           │    │        │       └ SocketInfo(<socket.socket fd=59, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 6192...
           │    │        └ <Server <ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0007215791343999399>>
           │    └ <pymongo.client_session.ClientSession object at 0x106727b50>
           └ <function MongoClient._run_operation_with_response.<locals>._cmd at 0x1066998b0>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1360, in _cmd
    return server.run_operation_with_response(
           │      └ <function Server.run_operation_with_response at 0x105dcbf70>
           └ <Server <ServerDescription ('localhost', 27017) server_type: Standalone, rtt: 0.0007215791343999399>>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/server.py", line 101, in run_operation_with_response
    message = operation.get_message(
              │         └ <function _Query.get_message at 0x105c6d9d0>
              └ <pymongo.message._Query object at 0x106728510>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/message.py", line 343, in get_message
    request_id, msg, size, _ = _op_msg(
                               └ <function _op_msg at 0x105c78820>
  File "/Users/antx/Code/prm/BcAppAPI/venv/lib/python3.8/site-packages/pymongo/message.py", line 714, in _op_msg
    return _op_msg_uncompressed(
           └ <built-in function _op_msg>

bson.errors.InvalidDocument: cannot encode object: {''}, of type: <class 'set'>
